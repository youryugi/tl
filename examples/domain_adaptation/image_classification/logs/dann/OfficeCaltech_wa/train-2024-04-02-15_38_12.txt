Namespace(arch='resnet50', batch_size=32, bottleneck_dim=256, data='OfficeCaltech', epochs=2, iters_per_epoch=2, log='logs/dann/OfficeCaltech_wa', lr=0.01, lr_decay=0.75, lr_gamma=0.001, momentum=0.9, no_hflip=False, no_pool=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), per_class_eval=False, phase='train', print_freq=1, ratio=[0.75, 1.3333333333333333], resize_size=224, root='data/OfficeCaltech', scale=[0.08, 1.0], scratch=False, seed=1, source=['W'], target=['A'], trade_off=1.0, train_resizing='default', val_resizing='default', weight_decay=0.001, workers=2)
dann.py:40: UserWarning: You have chosen to seed training. This will turn on the CUDNN deterministic setting, which can slow down your training considerably! You may see unexpected behavior when restarting from checkpoints.
  warnings.warn('You have chosen to seed training. '
train_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    RandomResizedCrop(size=(224, 224), scale=(0.08, 1.0), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
lr: 0.001
Epoch: [0][0/2]	Time 13.58 (13.58)	Data  0.00 ( 0.00)	Loss   3.21 (  3.21)	Cls Acc 0.0 (0.0)	Domain Acc 43.8 (43.8)
Epoch: [0][1/2]	Time 14.70 (14.14)	Data  0.01 ( 0.00)	Loss   2.14 (  2.68)	Cls Acc 93.8 (46.9)	Domain Acc 57.8 (50.8)
Test: [ 0/30]	Time  6.630 ( 6.630)	Loss 1.9299e+00 (1.9299e+00)	Acc@1 100.00 (100.00)
Test: [ 1/30]	Time  2.573 ( 4.602)	Loss 1.8709e+00 (1.9004e+00)	Acc@1 100.00 (100.00)
Test: [ 2/30]	Time  2.628 ( 3.944)	Loss 1.8635e+00 (1.8881e+00)	Acc@1 100.00 (100.00)
Test: [ 3/30]	Time  2.541 ( 3.593)	Loss 1.6796e+00 (1.8360e+00)	Acc@1 100.00 (100.00)
Test: [ 4/30]	Time  2.539 ( 3.382)	Loss 1.6580e+00 (1.8004e+00)	Acc@1 100.00 (100.00)
Test: [ 5/30]	Time  2.851 ( 3.294)	Loss 1.7768e+00 (1.7965e+00)	Acc@1 100.00 (100.00)
Test: [ 6/30]	Time  2.654 ( 3.202)	Loss 1.8568e+00 (1.8051e+00)	Acc@1 100.00 (100.00)
Test: [ 7/30]	Time  2.708 ( 3.141)	Loss 1.8334e+00 (1.8086e+00)	Acc@1 100.00 (100.00)
Test: [ 8/30]	Time  2.630 ( 3.084)	Loss 1.8467e+00 (1.8129e+00)	Acc@1 100.00 (100.00)
Test: [ 9/30]	Time  2.653 ( 3.041)	Loss 1.8777e+00 (1.8193e+00)	Acc@1 100.00 (100.00)
Test: [10/30]	Time  2.682 ( 3.008)	Loss 1.8897e+00 (1.8257e+00)	Acc@1 100.00 (100.00)
Test: [11/30]	Time  2.799 ( 2.991)	Loss 1.8339e+00 (1.8264e+00)	Acc@1 100.00 (100.00)
Test: [12/30]	Time  2.600 ( 2.961)	Loss 1.7822e+00 (1.8230e+00)	Acc@1 100.00 (100.00)
Test: [13/30]	Time  2.564 ( 2.932)	Loss 1.7875e+00 (1.8205e+00)	Acc@1 100.00 (100.00)
Test: [14/30]	Time  2.627 ( 2.912)	Loss 1.7757e+00 (1.8175e+00)	Acc@1 100.00 (100.00)
Test: [15/30]	Time  2.656 ( 2.896)	Loss 1.7650e+00 (1.8142e+00)	Acc@1 100.00 (100.00)
Test: [16/30]	Time  4.475 ( 2.989)	Loss 1.7167e+00 (1.8085e+00)	Acc@1 100.00 (100.00)
Test: [17/30]	Time  5.470 ( 3.127)	Loss 1.7054e+00 (1.8027e+00)	Acc@1 100.00 (100.00)
Test: [18/30]	Time  4.991 ( 3.225)	Loss 1.6226e+00 (1.7933e+00)	Acc@1 100.00 (100.00)
Test: [19/30]	Time  5.932 ( 3.360)	Loss 1.6785e+00 (1.7875e+00)	Acc@1 100.00 (100.00)
Test: [20/30]	Time  5.469 ( 3.461)	Loss 1.7041e+00 (1.7835e+00)	Acc@1 100.00 (100.00)
Test: [21/30]	Time  4.943 ( 3.528)	Loss 1.8280e+00 (1.7856e+00)	Acc@1 100.00 (100.00)
Test: [22/30]	Time  4.556 ( 3.573)	Loss 1.7897e+00 (1.7857e+00)	Acc@1 100.00 (100.00)
Test: [23/30]	Time  2.896 ( 3.544)	Loss 1.8066e+00 (1.7866e+00)	Acc@1 100.00 (100.00)
Test: [24/30]	Time  2.337 ( 3.496)	Loss 1.9098e+00 (1.7915e+00)	Acc@1 100.00 (100.00)
Test: [25/30]	Time  2.862 ( 3.472)	Loss 1.9274e+00 (1.7968e+00)	Acc@1 100.00 (100.00)
Test: [26/30]	Time  3.818 ( 3.485)	Loss 1.8969e+00 (1.8005e+00)	Acc@1 100.00 (100.00)
Test: [27/30]	Time  3.522 ( 3.486)	Loss 1.7689e+00 (1.7994e+00)	Acc@1 100.00 (100.00)
Test: [28/30]	Time  4.030 ( 3.505)	Loss 1.7669e+00 (1.7982e+00)	Acc@1 100.00 (100.00)
Test: [29/30]	Time  3.379 ( 3.501)	Loss 1.7776e+00 (1.7976e+00)	Acc@1 100.00 (100.00)
 * Acc@1 100.000
lr: 0.0009985026201965064
Epoch: [1][0/2]	Time 21.49 (21.49)	Data  0.00 ( 0.00)	Loss   1.24 (  1.24)	Cls Acc 100.0 (100.0)	Domain Acc 62.5 (62.5)
Epoch: [1][1/2]	Time 21.73 (21.61)	Data  0.01 ( 0.01)	Loss   0.74 (  0.99)	Cls Acc 100.0 (100.0)	Domain Acc 92.2 (77.3)
Test: [ 0/30]	Time  7.912 ( 7.912)	Loss 1.5647e+00 (1.5647e+00)	Acc@1 100.00 (100.00)
Test: [ 1/30]	Time  3.574 ( 5.743)	Loss 1.4797e+00 (1.5222e+00)	Acc@1 100.00 (100.00)
Test: [ 2/30]	Time  3.960 ( 5.149)	Loss 1.4791e+00 (1.5078e+00)	Acc@1 100.00 (100.00)
Test: [ 3/30]	Time  3.663 ( 4.777)	Loss 1.1722e+00 (1.4239e+00)	Acc@1 100.00 (100.00)
Test: [ 4/30]	Time  3.521 ( 4.526)	Loss 1.1337e+00 (1.3659e+00)	Acc@1 100.00 (100.00)
Test: [ 5/30]	Time  3.553 ( 4.364)	Loss 1.3771e+00 (1.3677e+00)	Acc@1 100.00 (100.00)
Test: [ 6/30]	Time  3.804 ( 4.284)	Loss 1.5247e+00 (1.3902e+00)	Acc@1 100.00 (100.00)
Test: [ 7/30]	Time  3.948 ( 4.242)	Loss 1.4721e+00 (1.4004e+00)	Acc@1 100.00 (100.00)
Test: [ 8/30]	Time  3.550 ( 4.165)	Loss 1.4927e+00 (1.4106e+00)	Acc@1 100.00 (100.00)
Test: [ 9/30]	Time  3.544 ( 4.103)	Loss 1.4677e+00 (1.4163e+00)	Acc@1 100.00 (100.00)
Test: [10/30]	Time  3.568 ( 4.054)	Loss 1.5087e+00 (1.4247e+00)	Acc@1 100.00 (100.00)
Test: [11/30]	Time  3.878 ( 4.040)	Loss 1.4488e+00 (1.4267e+00)	Acc@1 100.00 (100.00)
Test: [12/30]	Time  3.502 ( 3.998)	Loss 1.4032e+00 (1.4249e+00)	Acc@1 100.00 (100.00)
Test: [13/30]	Time  3.506 ( 3.963)	Loss 1.4033e+00 (1.4234e+00)	Acc@1 100.00 (100.00)
Test: [14/30]	Time  3.460 ( 3.929)	Loss 1.4025e+00 (1.4220e+00)	Acc@1 100.00 (100.00)
Test: [15/30]	Time  3.747 ( 3.918)	Loss 1.4167e+00 (1.4217e+00)	Acc@1 100.00 (100.00)
Test: [16/30]	Time  3.640 ( 3.902)	Loss 1.3250e+00 (1.4160e+00)	Acc@1 100.00 (100.00)
Test: [17/30]	Time  4.064 ( 3.911)	Loss 1.3038e+00 (1.4098e+00)	Acc@1 100.00 (100.00)
Test: [18/30]	Time  3.601 ( 3.894)	Loss 1.1404e+00 (1.3956e+00)	Acc@1 100.00 (100.00)
Test: [19/30]	Time  3.778 ( 3.889)	Loss 1.2241e+00 (1.3870e+00)	Acc@1 100.00 (100.00)
Test: [20/30]	Time  3.899 ( 3.889)	Loss 1.2444e+00 (1.3802e+00)	Acc@1 100.00 (100.00)
Test: [21/30]	Time  3.559 ( 3.874)	Loss 1.3945e+00 (1.3809e+00)	Acc@1 100.00 (100.00)
Test: [22/30]	Time  3.516 ( 3.858)	Loss 1.3621e+00 (1.3800e+00)	Acc@1 100.00 (100.00)
Test: [23/30]	Time  3.508 ( 3.844)	Loss 1.4004e+00 (1.3809e+00)	Acc@1 100.00 (100.00)
Test: [24/30]	Time  3.979 ( 3.849)	Loss 1.5713e+00 (1.3885e+00)	Acc@1 100.00 (100.00)
Test: [25/30]	Time  3.666 ( 3.842)	Loss 1.5812e+00 (1.3959e+00)	Acc@1 100.00 (100.00)
Test: [26/30]	Time  3.602 ( 3.833)	Loss 1.5382e+00 (1.4012e+00)	Acc@1 100.00 (100.00)
Test: [27/30]	Time  3.636 ( 3.826)	Loss 1.3470e+00 (1.3993e+00)	Acc@1 100.00 (100.00)
Test: [28/30]	Time  3.827 ( 3.826)	Loss 1.3443e+00 (1.3974e+00)	Acc@1 100.00 (100.00)
Test: [29/30]	Time  3.332 ( 3.810)	Loss 1.3529e+00 (1.3960e+00)	Acc@1 100.00 (100.00)
 * Acc@1 100.000
best_acc1 = 100.0
Test: [ 0/30]	Time  7.955 ( 7.955)	Loss 1.9299e+00 (1.9299e+00)	Acc@1 100.00 (100.00)
Test: [ 1/30]	Time  3.930 ( 5.943)	Loss 1.8709e+00 (1.9004e+00)	Acc@1 100.00 (100.00)
Test: [ 2/30]	Time  4.528 ( 5.471)	Loss 1.8635e+00 (1.8881e+00)	Acc@1 100.00 (100.00)
Test: [ 3/30]	Time  3.790 ( 5.051)	Loss 1.6796e+00 (1.8360e+00)	Acc@1 100.00 (100.00)
Test: [ 4/30]	Time  3.729 ( 4.786)	Loss 1.6580e+00 (1.8004e+00)	Acc@1 100.00 (100.00)
Test: [ 5/30]	Time  3.848 ( 4.630)	Loss 1.7768e+00 (1.7965e+00)	Acc@1 100.00 (100.00)
Test: [ 6/30]	Time  4.165 ( 4.564)	Loss 1.8568e+00 (1.8051e+00)	Acc@1 100.00 (100.00)
Test: [ 7/30]	Time  3.726 ( 4.459)	Loss 1.8334e+00 (1.8086e+00)	Acc@1 100.00 (100.00)
Test: [ 8/30]	Time  3.734 ( 4.378)	Loss 1.8467e+00 (1.8129e+00)	Acc@1 100.00 (100.00)
Test: [ 9/30]	Time  4.011 ( 4.342)	Loss 1.8777e+00 (1.8193e+00)	Acc@1 100.00 (100.00)
Test: [10/30]	Time  3.964 ( 4.307)	Loss 1.8897e+00 (1.8257e+00)	Acc@1 100.00 (100.00)
Test: [11/30]	Time  3.957 ( 4.278)	Loss 1.8339e+00 (1.8264e+00)	Acc@1 100.00 (100.00)
Test: [12/30]	Time  3.665 ( 4.231)	Loss 1.7822e+00 (1.8230e+00)	Acc@1 100.00 (100.00)
Test: [13/30]	Time  3.652 ( 4.190)	Loss 1.7875e+00 (1.8205e+00)	Acc@1 100.00 (100.00)
Test: [14/30]	Time  3.780 ( 4.162)	Loss 1.7757e+00 (1.8175e+00)	Acc@1 100.00 (100.00)
Test: [15/30]	Time  3.563 ( 4.125)	Loss 1.7650e+00 (1.8142e+00)	Acc@1 100.00 (100.00)
Test: [16/30]	Time  3.752 ( 4.103)	Loss 1.7167e+00 (1.8085e+00)	Acc@1 100.00 (100.00)
Test: [17/30]	Time  3.661 ( 4.078)	Loss 1.7054e+00 (1.8027e+00)	Acc@1 100.00 (100.00)
Test: [18/30]	Time  3.984 ( 4.073)	Loss 1.6226e+00 (1.7933e+00)	Acc@1 100.00 (100.00)
Test: [19/30]	Time  3.675 ( 4.054)	Loss 1.6785e+00 (1.7875e+00)	Acc@1 100.00 (100.00)
Test: [20/30]	Time  3.602 ( 4.032)	Loss 1.7041e+00 (1.7835e+00)	Acc@1 100.00 (100.00)
Test: [21/30]	Time  3.625 ( 4.014)	Loss 1.8280e+00 (1.7856e+00)	Acc@1 100.00 (100.00)
Test: [22/30]	Time  3.882 ( 4.008)	Loss 1.7897e+00 (1.7857e+00)	Acc@1 100.00 (100.00)
Test: [23/30]	Time  3.815 ( 4.000)	Loss 1.8066e+00 (1.7866e+00)	Acc@1 100.00 (100.00)
Test: [24/30]	Time  3.615 ( 3.984)	Loss 1.9098e+00 (1.7915e+00)	Acc@1 100.00 (100.00)
Test: [25/30]	Time  3.587 ( 3.969)	Loss 1.9274e+00 (1.7968e+00)	Acc@1 100.00 (100.00)
Test: [26/30]	Time  3.757 ( 3.961)	Loss 1.8969e+00 (1.8005e+00)	Acc@1 100.00 (100.00)
Test: [27/30]	Time  4.120 ( 3.967)	Loss 1.7689e+00 (1.7994e+00)	Acc@1 100.00 (100.00)
Test: [28/30]	Time  3.811 ( 3.962)	Loss 1.7669e+00 (1.7982e+00)	Acc@1 100.00 (100.00)
Test: [29/30]	Time  3.307 ( 3.940)	Loss 1.7776e+00 (1.7976e+00)	Acc@1 100.00 (100.00)
 * Acc@1 100.000
test_acc1 = 100.0
